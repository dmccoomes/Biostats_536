---
title: "Homework 3"
author: "David Coomes"
date: "Due 10/31/2019"
output: html_document
---

```{r install_packages, echo=FALSE,warning=FALSE,message=FALSE}

library(knitr)
library(devtools)
#install_github("bmckuw/UWbe536") 
library(UWbe536) 
library(kableExtra)

```


```{r read_data, include=FALSE,warning=FALSE,message=FALSE}

link = "https://github.com/dmccoomes/Biostats_536/raw/master/Homework%203/esoph%20(2).rds"
esoph <- readRDS(url(link))
head(esoph)
summary(esoph)
str(esoph)

```


<<<<<<< HEAD
```{r shape_data, warning=FALSE,message=FALSE, include=FALSE}
=======
```{r shape_data, echo=FALSE,warning=FALSE,message=FALSE, include=FALSE}
>>>>>>> a01488fd339c7b4b4912b2fd197f7881fb82db19

esoph$bin_alc <- as.numeric(esoph$alc) > 2
esoph$bin_alc <- factor(esoph$bin_alc, labels = c("0-79","80+"))

esoph$bin_tob <- as.numeric(esoph$tob) > 2
esoph$bin_tob <- factor(esoph$bin_tob, labels = c("0-19", "20+"))

with(esoph, table(alc, bin_alc))
with(esoph, table(tob, bin_tob))

```

<br>

### **Question #1** 
### (a) logit(p) = alpha(0) + alpha(1)*X(tob) + beta*X(alc)

    X(tob) =  0 if tobacco use is 0-19 grams/day,
              1 if tobacco use is 80+ grams/day
              
    X(alc) =  0 if alcohol use is 0-79 grams/day
              1 if alcohol use is 80+ grams/day
              
    p = probability of esophageal cancer
    
    
### (b) OR = e^(beta)


### (c) 

Odds ratio of esophageal cancer associated with more than 80 g/day alcohol consumption as compared with less than 80 g/day and adjusted for tobacco consumption

```{r logit_model, warning=FALSE,message=FALSE, echo=FALSE}

bin_alc.mod <- glm(case ~ bin_alc + bin_tob, data=esoph, family=binomial)
OR <- exp(coef(bin_alc.mod)[2])
ci <- exp(confint.default(bin_alc.mod))[2,]

kable(round(cbind(OR, t(ci)),2)) %>%
  kable_styling(full_width=F, position="left")
      

```

### (d) 

The OR of being diagnosed with esophageal cancer associated with high alchohol consumption (80 g/day or more) compared to not high alcohol consumption (<80 g/day) and adjusted for tobacco consumption is 5.61 (95% CI: 3.97-7.93).


<br>


### **Question #2**
### (a) logit(p) = alpha(0) + alpha(1)*X(tob) + beta*X(alc)

    X(tob) =  0 if tobacco use is 0-19 grams/day
              1 if tobacco use is 80+ grams/day
              
    X(alc) =  0 if alcohol use is 0-79 grams/day
              1 if alcohol use is 80+ grams/day
              
    p = probability of esophageal cancer among men
    
    
### (b) OR = e^(beta)


### (c) 

Odds ratio of esophageal cancer among men associated with more than 80 g/day alcohol consumption as compared with less than 80 g/day and adjusted for tobacco consumption

```{r logit_model, warning=FALSE,message=FALSE, echo=FALSE}

bin_alc.mod <- glm(case ~ bin_alc + bin_tob, data=esoph, family=binomial)
OR <- exp(coef(bin_alc.mod)[2])
ci <- exp(confint.default(bin_alc.mod))[2,]

kable(round(cbind(OR, t(ci)),2)) %>%
  kable_styling(full_width=F, position="left")
      

```





